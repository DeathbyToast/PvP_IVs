<!DOCTYPE html>
<html lang="en-US">

<head>
  <!-- GA4 Tag -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LQY2YVNT21"></script><script>window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date()); gtag('config', 'G-LQY2YVNT21');</script>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TDF58VB');</script>
  <!-- End Google Tag Manager -->
  <meta charset="UTF-8">
  <link rel="canonical" href="https://pvpivs.com/" />
  <!-- Include pre-loads to reduce/optimize page load time-->
  <link rel="preload" href="https://pvpivs.com/includes/style.css" as="style">
  <link rel="preload" href="https://pvpivs.com/includes/footer.js" as="script">
  <link rel="preload" href="https://pvpivs.com/includes/calculate.js" as="script">
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.css" as="style">
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js" as="script">
  <link rel="preload" href="https://pvpivs.com/includes/pokeListObj.js" as="script">
  <link rel="preload" href="https://code.jquery.com/jquery-3.7.1.slim.min.js" as="script" integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8=" crossorigin="anonymous">
  <title>PvP IVs - Rankings</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description"
    content="PvP IVs lookup tool for Pok&eacute;mon Go&trade; to help compare your Pok&eacute;mon's PvP IVs to ideal PvP IVs. Finds PvP IVs for any wild-caught, weather boosted, traded, raided, hatched, and even purified Pok&eacute;mon! Did you catch the very best?" />
  <link rel=icon href=https://pvpivs.com/includes/favicon.png>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.css">
  <link rel="stylesheet" href="https://pvpivs.com/includes/style.css">
  <style>
    /* control highlight of trading improvement rows based on % chace to improve post-trade
       * also controls the output row highlighting for user entered IVs (#outTable)
       * 1000/4096 ~= 0.2442 and 100/4096 ~= 0.02442
       * use 0.02442 to approximate "Top 100" (green) when there are less than 4096 results
       * use 0.2442 to approximate "Top 1000" (orange) when there are less than 4096 results */
    #outTable tr.good>*,
    #familyTable tr.good>*,
    #tradeTable tr.highMaxRow>* {
      background-color: var(--goodResult);
      color: var(--navActiveText);
    }

    #outTable tr.ok>*,
    #familyTable tr.ok>*,
    #tradeTable tr.okMaxRow>* {
      background-color: var(--okResult);
      color: var(--navActiveText);
    }

    #outTable tr.rubbish>*,
    #familyTable tr.rubbish>*,
    #tradeTable tr.lowMaxRow>* {
      background-color: var(--badResult);
      color: var(--navActiveText);
    }

    /* the > * operator applies the css to all children (cells) */
    #outTable,
    #familyTable a {
      color: var(--navActiveText);
    }

    input[type=number] {
      width: 44px;
    }

    input[id=pokeList] {
      width: 111px;
    }

    /* Plus/Minus Buttons */
    /* https://stackoverflow.com/q/33766350 */
    .circle {
      border: 1px solid var(--navBackground);
      box-shadow: inset 1px 1px 1px var(--tableDividers);
      width: 18px;
      height: 18px;
      border-radius: 100%;
      position: relative;
      margin: 4px;
      display: inline-block;
      vertical-align: middle;
      background: #aaaaaa4f;
    }

    .circle:hover {
      background: radial-gradient(var(--textBoxBg), var(--tableHeaderBg));
    }

    .circle:active {
      background: var(--navActive);
    }

    .circle:before,
    .circle:after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }

    /* PLUS */
    .circle.plus:before,
    .circle.plus:after {
      background: green;
    }

    .circle.plus:before {
      width: 2px;
      margin: 3px auto;
    }

    .circle.plus:after {
      margin: auto 3px;
      height: 2px;
    }

    /* MINUS */
    .circle.minus:before {
      background: #cc0000;
      margin: auto 3px;
      height: 2px;
    }

    #totalRanks {
      display: inline;
    }

    p[id=IVinputShow],
    small[id=IVinputHide] {
      text-decoration: underline;
      text-decoration-color: blue;
    }

    #ivInputTable, #lvlSelect, #cpInput {
      font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
      margin-left:auto;
      margin-right:auto;
    }
  </style>
  <!-- Begin Playwire Head -->
  <script>window.ramp=window.ramp ||{}; window.ramp.que=window.ramp.que || []; </script> <script async src="//cdn.intergient.com/1025030/74482/ramp_config.js"></script> <script>window._pwGA4PageviewId=''.concat(Date.now()); window.dataLayer=window.dataLayer || []; window.gtag=window.gtag || function (){dataLayer.push(arguments);}; gtag('js', new Date()); gtag('config', 'G-JD7R9RWFZL',{'send_page_view': false}); gtag( 'event', 'ramp_js',{'send_to': 'G-JD7R9RWFZL', 'pageview_id': window._pwGA4PageviewId}); </script>
  <!-- End Playwire Head -->
</head>

<body class="dark-theme">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TDF58VB" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <header>
    <ul class="header">
      <li class="dropdown active left">
        <a href="javascript:void(0)" class="dropbtn active">PvP IVs</a>
        <div class="dropdown-content">
          <a href="/">Rankings (Single)</a>
          <a href="/leagueRanks.html">Rankings (League)</a>
          <a href="/searchStr.html">Search Strings</a>
          <a href="/calculator.html" class="active">Calculator</a>
        </div>
      </li>
      <li class="dropdown left">
        <a href="javascript:void(0)" class="dropbtn">Typing</a>
        <div class="dropdown-content">
          <a href="/typeLookup.html">Chart</a>
          <a href="/typeQuiz.html">Quiz</a>
        </div>
      </li>
      <li class="flat right">
        <label class="theme-toggle-switch">
          <img id="theme-toggle-icon" src="https://pvpivs.com/includes/dark_mode_icon_white-fill.png" alt="Dark Mode"
            width="22" height="22">
          <div>
            <input id="theme-toggle" type="checkbox" />
            <span class="slider round"></span>
          </div>
        </label>
      </li>
      <li class="dropdown active right">
        <a href="javascript:void(0)" class="dropbtn">About</a>
        <div class="dropdown-content">
          <a href="/about.html">About PvP IVs</a>
          <a href="/contact.html">Contact Us</a>
          <a href="/privacy.html">Privacy Policy</a>
          <a href="/cookies.html">Cookie Policy</a>
        </div>
      </li>
    </ul>
  </header>
  <br />
  <section>
    <input id="pokeList" onfocus="this.value=''" placeholder="Pok&eacute;mon"/>
    <br /><br />
    <table id="ivInputTable">
      <tr>
        <td title="Your Attack IV">Atk</td>
        <td title="Your Defense IV">Def</td>
        <td title="Your Stamina IV">Sta</td>
      </tr>
      <tr>
        <td>
          <select title="Your Attack IV" class="aIV" id="aIV">
            <option value=""></option> 
            <option value="15">15</option>
            <option value="14">14</option>
            <option value="13">13</option>
            <option value="12">12</option>
            <option value="11">11</option>
            <option value="10">10</option>
            <option value="9">9</option>
            <option value="8">8</option>
            <option value="7">7</option>
            <option value="6">6</option>
            <option value="5">5</option>
            <option value="4">4</option>
            <option value="3">3</option>
            <option value="2">2</option>
            <option value="1">1</option>
            <option value="0">0</option>
          </select>
        </td>
        <td>
          <select title="Your Defense IV" id="dIV">
            <option value=""></option> 
            <option value="15">15</option>
            <option value="14">14</option>
            <option value="13">13</option>
            <option value="12">12</option>
            <option value="11">11</option>
            <option value="10">10</option>
            <option value="9">9</option>
            <option value="8">8</option>
            <option value="7">7</option>
            <option value="6">6</option>
            <option value="5">5</option>
            <option value="4">4</option>
            <option value="3">3</option>
            <option value="2">2</option>
            <option value="1">1</option>
            <option value="0">0</option>
          </select></td>
        <td>
          <select title="Your Stamina IV" id="sIV">
            <option value=""></option> 
            <option value="15">15</option>
            <option value="14">14</option>
            <option value="13">13</option>
            <option value="12">12</option>
            <option value="11">11</option>
            <option value="10">10</option>
            <option value="9">9</option>
            <option value="8">8</option>
            <option value="7">7</option>
            <option value="6">6</option>
            <option value="5">5</option>
            <option value="4">4</option>
            <option value="3">3</option>
            <option value="2">2</option>
            <option value="1">1</option>
            <option value="0">0</option>
          </select></td>
      </tr>
    </table>
    <br /><label for="level" id="lvlSelect">Level: </label>
    <select title="Your Level" id="level">
      <option value=""></option>  
      <option value="51">51</option>
      <option value="50.5">50.5</option>
      <option value="50">50</option>
      <option value="49.5">49.5</option>
      <option value="49">49</option>
      <option value="48.5">48.5</option>
      <option value="48">48</option>
      <option value="47.5">47.5</option>
      <option value="47">47</option>
      <option value="46.5">46.5</option>
      <option value="46">46</option>
      <option value="45.5">45.5</option>
      <option value="45">45</option>
      <option value="44.5">44.5</option>
      <option value="44">44</option>
      <option value="43.5">43.5</option>
      <option value="43">43</option>
      <option value="42.5">42.5</option>
      <option value="42">42</option>
      <option value="41.5">41.5</option>
      <option value="41">41</option>
      <option value="40.5">40.5</option>
      <option value="40">40</option>
      <option value="39.5">39.5</option>
      <option value="39">39</option>
      <option value="38.5">38.5</option>
      <option value="38">38</option>
      <option value="37.5">37.5</option>
      <option value="37">37</option>
      <option value="36.5">36.5</option>
      <option value="36">36</option>
      <option value="35.5">35.5</option>
      <option value="35">35</option>
      <option value="34.5">34.5</option>
      <option value="34">34</option>
      <option value="33.5">33.5</option>
      <option value="33">33</option>
      <option value="32.5">32.5</option>
      <option value="32">32</option>
      <option value="31.5">31.5</option>
      <option value="31">31</option>
      <option value="30.5">30.5</option>
      <option value="30">30</option>
      <option value="29.5">29.5</option>
      <option value="29">29</option>
      <option value="28.5">28.5</option>
      <option value="28">28</option>
      <option value="27.5">27.5</option>
      <option value="27">27</option>
      <option value="26.5">26.5</option>
      <option value="26">26</option>
      <option value="25.5">25.5</option>
      <option value="25">25</option>
      <option value="24.5">24.5</option>
      <option value="24">24</option>
      <option value="23.5">23.5</option>
      <option value="23">23</option>
      <option value="22.5">22.5</option>
      <option value="22">22</option>
      <option value="21.5">21.5</option>
      <option value="21">21</option>
      <option value="20.5">20.5</option>
      <option value="20">20</option>
      <option value="19.5">19.5</option>
      <option value="19">19</option>
      <option value="18.5">18.5</option>
      <option value="18">18</option>
      <option value="17.5">17.5</option>
      <option value="17">17</option>
      <option value="16.5">16.5</option>
      <option value="16">16</option>
      <option value="15.5">15.5</option>
      <option value="15">15</option>
      <option value="14.5">14.5</option>
      <option value="14">14</option>
      <option value="13.5">13.5</option>
      <option value="13">13</option>
      <option value="12.5">12.5</option>
      <option value="12">12</option>
      <option value="11.5">11.5</option>
      <option value="11">11</option>
      <option value="10.5">10.5</option>
      <option value="10">10</option>
      <option value="9.5">9.5</option>
      <option value="9">9</option>
      <option value="8.5">8.5</option>
      <option value="8">8</option>
      <option value="7.5">7.5</option>
      <option value="7">7</option>
      <option value="6.5">6.5</option>
      <option value="6">6</option>
      <option value="5.5">5.5</option>
      <option value="5">5</option>
      <option value="4.5">4.5</option>
      <option value="4">4</option>
      <option value="3.5">3.5</option>
      <option value="3">3</option>
      <option value="2.5">2.5</option>
      <option value="2">2</option>
      <option value="1.5">1.5</option>
      <option value="1">1</option>
    </select><br/>
    <br /><label for="cp" id="cpInput">CP: </label><input type="number" id="cp" min="10">
          <label for="hp" id="hpInput">HP: </label><input type="number" id="hp" min="10">
    <br /><br />
    <span style="overflow-x:auto;" id="outputBox"><i>Please enter a valid Pok&eacute;mon above to 
      continue...</i></span>
    <br />

    <!-- Footer Code Below -->
    <script src="https://pvpivs.com/includes/footer.js"></script>
    <script src="includes/calculateCP.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js"></script>
    <script src="https://pvpivs.com/includes/pokeListObj.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js" integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8=" crossorigin="anonymous"></script>

    <script>
      $( document ).ready(function() {

        /* Run main() whenever user adds new input */
        $("#aIV, #dIV, #sIV, #level, #cp, #hp").on( "change", function() {main();} );

        var perfTiming = true; /* used for timing execution */
        var input = document.getElementById("pokeList");
        var monNames = Object.keys(pokeListObj);
        /* Ensure we've successfully loaded pokeListObj, and converted to list for awesomplete */
        if (monNames.length < 1000) /* At time of writing, monNames.length was 1025 */ {
          console.error("monNames.length (" + monNames.length + ") shorter than expected (1000), check pokeListObj load");
          document.getElementById('feedbackBox').innerHTML = "<p><i>ERROR: Failed to load, please try again.<br>If this issue persists, please <a href='https://discord.gg/UD4Temq'>contact us on Discord</i></p>";
          console.log("pokeListObj: " + JSON.stringify(pokeListObj));
          console.log("monNames: " + JSON.stringify(monNames));
        } else {
          new Awesomplete(input, { list: monNames });
          /*https://github.com/LeaVerou/awesomplete/issues/16438#issuecomment-195921708*/
          Awesomplete.$.bind(input, {
            "awesomplete-selectcomplete": function (evt) {
              /*console.log("User Selected "+evt.text.label+", passing to main and exiting Awesomplete");*/
              main();
            }
          });
          /* end Awesomeplete https://leaverou.github.io/awesomplete/ */
        }
      });

      function main() {
        let pokemon = document.getElementById("pokeList")?.text?.label;
        if (!pokemon) pokemon = document.getElementById("pokeList")?.value
        if (pokemon && pokeListObj[pokemon]) {
          calcCP(pokemon);
        } else {
          console.log("calcCP: Still waiting for pokemon input, read: "+pokemon);
        }
        //calcInputLevel();
      }

      function calcCP(pokemon) {
        var T0;
        if (perfTiming) {T0 = performance.now();}

        const aIV = $("#aIV").val();
        const dIV = $("#dIV").val();
        const sIV = $("#sIV").val();
        const level = $("#level").val();
        const cp = $("#cp").val();
        const hp = $("#hp").val();

        //console.log("calcCP: Received "+pokemon+" inputs: aIV: "+aIV+", dIV: "+dIV+", sIV: "+sIV+", level: "+level+", cp: "+cp+", hp: "+hp);
        
        if ((aIV && sIV && dIV && (level || cp)) || (level && cp)) {
          const monInfo = pokeListObj[pokemon].split(',');
          const baseAtk = parseInt(monInfo[1], 10);
          const baseDef = parseInt(monInfo[2], 10);
          const baseSta = parseInt(monInfo[3], 10);

          if (level) {
            if (cp/1>=10) {
              /* Calculate IVs from level and CP */
              const cpmIndex = Math.round((level - 1) * 2);
              var possibleIVs = [];
              for (var a=15; a>=0; a--) {
                for (var d=15; d>=0; d--) {
                  for (var s=15; s>=0; s--) {
                    const computedCP = Math.max(10, Math.floor((baseAtk + a/1) * Math.sqrt(baseDef + d/1) * Math.sqrt(baseSta + s/1) * cpm[cpmIndex] * cpm[cpmIndex] / 10));
                    const computedHP = Math.floor((baseSta + s/1)*cpm[cpmIndex]);
                    if (cp/1 == computedCP/1) {
                      if (hp/1>=10) {
                        if (hp/1 == computedHP/1) {
                          /* Matched HP and CP! */
                          possibleIVs.push([a,d,s]);
                        }
                      } else {
                        /* Matched CP, no HP input */
                        possibleIVs.push([a,d,s]);
                      }
                    }
                  }
                }
              }
              //console.log("Found possible IVs: "+JSON.stringify(possibleIVs));
              $("#outputBox").text(`${pokemon} Possible IVs: ${JSON.stringify(possibleIVs)}`);
            } else {
              /* Did not receive CP, need to compute CP instead */
              const cpmIndex = Math.round((level - 1) * 2);
              const computedCP = Math.max(10, Math.floor((baseAtk + aIV/1) * Math.sqrt(baseDef + dIV/1) * Math.sqrt(baseSta + sIV/1) * cpm[cpmIndex] * cpm[cpmIndex] / 10));
              $("#outputBox").text(`${pokemon} CP: ${computedCP}`);
            }
          } else if (cp/1>=10) {
            /* TODO: Reverse formula to solve for level rather than brute force looping to find level*/
            var foundCP = false;
            for (var i=0; i<cpm.length; i++) {
              var computedCP = Math.max(10, Math.floor((baseAtk + aIV/1) * Math.sqrt(baseDef + dIV/1) * Math.sqrt(baseSta + sIV/1) * cpm[i] * cpm[i] / 10));
              if (computedCP == cp) {
                var computedLevel = i/2 + 1;
                $("#outputBox").text(`${pokemon} Level: ${computedLevel}`);
                foundCP = true;
                break;
              } else if (computedCP/1 > cp/1) {
                console.log("calcCP: Already overshot target CP("+cp+") with computedCP("+computedCP+"), exiting loop");
                $("#outputBox").text("Unable to find correct level, please check your inputs and try again");
                if (perfTiming) {stopTiming(T0, "calcCP");}
                
                return;
              }
            }
            if (foundCP == false) {
              $("#outputBox").text("Unable to find correct level, please check your inputs and try again");
            }
          }
        } else {
          console.log("calcCP: Missing one or more required inputs for "+pokemon+": aIV: "+aIV+", dIV: "+dIV+", sIV: "+sIV+", level: "+level+", cp: "+cp);
          $("#outputBox").html("<b>Please enter any two of IVs, level, and CP to continue</b><br/><i>If IVs are unknown, HP will help narrow down possibile calcualted IVs</i>");
        } 
      }

      function calcInputLevel() {
        const aIV = parseInt(document.getElementById('levelAttackIV').value, 10);
        const dIV = parseInt(document.getElementById('levelDefenseIV').value, 10);
        const sIV = parseInt(document.getElementById('levelStaminaIV').value, 10);
        const inputCP = parseInt(document.getElementById('combatPowerInput').value, 10);
        let pokemon = document.getElementById("pokeList")?.text?.label;
        if (!pokemon) pokemon = document.getElementById("pokeList")?.value
        let attack = 0;
        let defense = 0;
        let stamina = 0;

        if (pokemon && pokeListObj[pokemon]) {
          const monInfo = pokeListObj[pokemon].split(',');
          attack = parseInt(monInfo[1], 10);
          defense = parseInt(monInfo[2], 10);
          stamina = parseInt(monInfo[3], 10);
          const levelElement = document.getElementById("level");
          const level = calculateLevel(attack, defense, stamina, aIV, dIV, sIV, inputCP);
          if (levelElement) {
            if (level >= 1 && level <= 51) {
              levelElement.textContent = `Pokemon: ${pokemon} CP: ${inputCP} Level:${level}`;
            }
            else {
              levelElement.textContent = `Pokemon: ${pokemon} CP: ${inputCP} Could not find a matching level`;
            }
          }
        }

      }

      function stopTiming(startTime, functionName) {
        var endTime = performance.now();
        console.log(functionName + ": Execution took " + (endTime - startTime).toFixed(1) + "ms");
        document.getElementById('timing_outputs').innerHTML += functionName + ": Execution took " + (endTime - startTime).toFixed(1) + "ms<br>";
      }
    </script>
    <br/><br/><br/>
    <div style="overflow-x:auto;">
      <p style="color: var(--tableHeaderText);font-size:0.8em">© 2023 PvP IVs | <a href="https://pvpivs.com/privacy">Privacy Policy</a> | <a href="https://pvpivs.com/contact">Contact Us</a></p>
      <p style="color: var(--tableHeaderText);font-size:0.6em">Pokémon and Pokémon GO are copyright of The Pokémon Company, Niantic, Inc., and Nintendo.<br/>All trademarked images and names are property of their respective owners, and any such material is used on this site for educational purposes only.<br/>PvP IVs has no affiliation with The Pokémon Company, Niantic, Inc., or Nintendo.</p>
    </div><p style="overflow-x:auto;" id="timing_outputs"></p>
  </section>
</body>

</html>
